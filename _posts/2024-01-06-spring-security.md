---
layout: post
title: Spring Security 주요 기능 - 1편
date: 2024-01-06 00:00:00 +0000
category : Spring
---

## Spring Security란? 

Spring Security는 Java 애플리케이션, 특히 Spring 프레임워크를 사용하는 웹 애플리케이션의 보안을 담당하는 프레임워크이다. 개발하면서 보안쪽은 시간을 많이 쏟아야하는 부분 중 하나인데, Spring Security는 복잡함을 줄여주고, 보안을 쉽고 강력하게 만들어주는 도구라고 할 수 있다. 

제공하는 주요 기능은 아래와 같다.

* 인증(Authentication)
* 권한 부여(Authorization)
* CSRF 보호
* 세션관리
* 외부 인증(LDAP, OAuth2, OpenID Connect) 통합
* 보안 헤더 관리
* 사용자 정의 보안 기능

### 인증(Authentication)과 권한 부여(Authorization)

* 인증(Authentication) : 인증은 사용자가 누구인지 확인하는 과정이라고 보면 된다. 즉 사용자의 신원을 검증하는 것이 목적인데, 일반적으로 사용자의 이름과 비밀번호를 입력하는 것이 인증에 해당된다. 추가적으로 이중 인증(2FA)이나 MFA 같은 방법도 있다. 

* 권한 부여(Authorization) : 권한부여는 인증된 사용자가 시스템 내에서 어떤 리소스에 접근하거나 어떤 작업을 수행할 수 있는지를 정의한다. 예를 들어 사용자가 로그인 후 특정 페이지에 접근하려고 할 때, 그 사용자가 해당 페이지에 접근할 수 있는 권한이 있는지 확인하는 것이 권한 부여(Authorization)에 해당된다.   

즉, 인증은 '사용자가 누구인가'를 확인하려는 것이고, 권한 부여는 '사용자가 무엇을 할 수 있는가'를 결정하는 것이다. 보통 인증은 시스템에 처음 접근할때 수행되고, 권한 부여는 인증된 사용자가 특정 리소스에 접근하려 할 때 수행된다. 


### CSRF

CSRF(Cross-Site Request Forgery)는 웹 애플리케이션의 보안을 위협하는 공격 유형 중 하나이다.  

<aside>
  <span class="icon">🥕</span> 
  <div class="content">
    <p>은행 웹 사이트에 로그인해서 온라인으로 금융업무를 보고 있다고 가정하자.</p>
    <p>동시에 다른 탭에서 이메일 확인하고 있었는데, 친구가 보낸 것처럼 보이는 링크가 있어서 클릭했다. 만약 악의적인 목적으로 만들어진 것이라면 내가 모르는 사이에 '돈을 송금하는' 요청을 보낼 수 있다. </p>
    <p>왜냐하면, 이미 은행 사이트에 로그인해 있기 때문에 그 브라우저는 그 요청을 정상적인 것으로 간주하고 나의 로그인 정보를 함께 전송할 수 있다. 이것이 CSRF 공격의 핵심이다.</p>
  </div>
</aside>

CSRF 공격의 특징으로는 다음과 같다.  

* 공격은 사용자가 자신도 모르게 이루어지기 때문에 사용자는 자신이 공격을 도와주고 있다는 사실을 인지하지 못한다.  
* 인증된 사용자의 세션을 이용하여 악의적인 행위를 한다.  
* 사용자가 의도하지 않은 행동(송금, 비밀번호 변경 등)을 하도록 요청을 위장하여 보낸다. 

#### CSRF 공격은 어떻게 방지할 수 있을까?  

1. CSRF 토큰 사용 : 서버는 폼을 제출할 때마다 고유한 토큰을 생성하여 사용자가 이 토큰을 함께 제출핟록 한다.  
2. 세션 확인 : 사용자의 세션을 확인하여 요청이 같은 출처에서 온 것인지 검증한다.  
3. 사용자 인터랙션 요구 : 중요한 작업을 수행하기 전에 사용자 인터랙션(비밀번호 재입력, 캡차 등)을 요구한다.  
 

### Session  
Spring Security에서 제공하는 주요 세션 관리 기능은 아래와 같다.  

1. 세션 고정 보호 : 로그인 시 자동으로 새로운 세션을 생성하여 이전 세션 ID를 무효화시킨다.  
2. 동시 세션 제어 : 사용자가 동시에 여러 세션을 열지 못하도록 제어한다.  
3. 세션 만료 및 타임아웃 관리 : 특정 기간 동안 활동이 없는 세션을 자동으로 만료시키는 기능을 제공한다.  
4. 세션 정책 설정 : 언제 새로운 세션을 생성할지 제어할 수 있다.   
5. 세션에 대한 CSRF 보호 : CSRF 토큰을 세션에 저장하고 관리하여, CSRF 공격으로부터 보호한다.  

